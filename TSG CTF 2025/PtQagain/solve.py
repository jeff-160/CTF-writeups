from Crypto.Util.number import long_to_bytes
import math

N = 8415991046378822808678417368330656853369287762382257778863000234996179456832593823172163438175141897794450973258850755059008064965170892039119019048620633841637561375984016774249397631671121650489315360389403325290330278785155612107593553850666774120554971030956010302235061389242836031692105637093
e1 = 65537
e2 = 65583
c = 5574165375242524333573826610902926393700854735994229967966464169834696611810072076594787795367537651736635669504446868847168099681864093409935801174468222766808668365620150398151512438201199626223130807413078543403236814636420490358773639850910401283271784777683577389622203357416804633487506912900
c1 = 3733372451275945143106630642525005607134287402204217261131967501254130116356869822445109935329406396349828170813887809941457012269457680164427423918812605964033393533444248389803553681873885855742856069057392986629579993551342614294600091763375588208870704928674561853194758243753269168083341300444
c2 = 3733372451275945143106630642525005607134287402204217261131967501254130116356869822445109935329406396349828170813887809941457012269457680164427423918812605964033393533444248389803553681873885855742856069057392986629579993551342614294600091763375588208870704928674561853194758243753269168083341300444

e2_inv_root = round(c1 ** (1/e2))

for len_q in range(140, 155):
    d_coeff = 10**len_q - 1
    
    for k in range(1, 1000):
        d = k * d_coeff
              
        for test_x in [2, 3, 5, 7, 11]:
            f_val = pow(test_x + d, e2, N) - pow(test_x, e2, N)
            f_val = f_val % N
            g = math.gcd(f_val, N)
            if g > 1 and g < N:
                p_candidate = g
                q_candidate = N // g
                
                phi = (p_candidate - 1) * (q_candidate - 1)
                d1 = pow(e1, -1, phi)
                m = pow(c, d1, N)

                flag = long_to_bytes(m)
                print("Flag:", flag.decode())
                exit()